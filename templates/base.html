<!doctype html>
<head>
  <title>{% block title %}{{title}}{% endblock %} - TTRPG-Hangout.com</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script data-goatcounter="https://enfors.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</head>
  
<body>
  <header>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <a href="/"><img src="/images/TTRPG-banner-logo.webp" class="banner"></a>
  </header>
  <!-- The page -->
  <main>
    <div>
      <!-- The header -->
      {% block header %}{% endblock %}
      <!-- Flash messages -->
      {% for message in get_flashed_messages() %}
      <div class="flash">{{ message }}</div>
      {% endfor %}
        {% block content %}{% endblock %}
    </div>
  </main>

  <!-- The sidebar -->
  <aside class="sidebar">
    <nav>
      <div>
        <ul>
          <li>
            <a href="https://ttrpg-hangout.social">TTRPG-Hangout.social</a>:
            The Mastodon instance associated with this site.
          </li>
          <li><a href="/about_ttrpg_hangout.html">About</a> this site and its author.</li>
        </ul>
      </div>
    </nav>

    <!-- Recent -->
    <recent>
      <div>
        <h2>Recent articles</h2>
        <ul>
          <li><a href="quantity_oracle.html">Quantity Oracle</a></li>
          <li><a href="action_theme_oracle.html">Action/Theme Oracle</a></li>
          <li><a href="yes_no_oracle.html">Yes/No Oracle</a></li>
          <li><a href="2d6_weather_system.html">2d6 Weather System</a></li>
          <li><a href="location_generator.html">Location Generator</a></li>
          <li><a href="npc_generator.html">NPC Generator</a></li>
          <li><a href="context_aware_random_tables.html">Context-aware Random Tables</a></li>
          <li><a href="travel_and_exploration_in_rpgs.html">Travel and Explorationin RPGs</a></li>
          <li><a href="why_play_roleplaying_games_alone.html">Why Play Roleplaying Games Alone</a></li>
        </ul>
      </div>
    </recent>

    <!-- TTRPG-Hangout.social public timeline -->
    <socialtimeline>
      <div class="sidebar-widget">
        <h3>Live at TTRPG-Hangout.social</h3>
        <div id="mastodon-timeline">Loading...</div>
        <p style="text-aligh; right; font-size: 0.8rem;">
          <a href="https://ttrpg-hangout.social/public/local" target="_blank">View more&rarr;</a>
        </p>
      </div>

      <script>
document.addEventListener("DOMContentLoaded", function() {
    const instance = "https://ttrpg-hangout.social";
    const container = document.getElementById("mastodon-timeline");
    
    // Fetch local timeline, limit to 3 posts
    fetch(`${instance}/api/v1/timelines/public?local=true&limit=3`)
        .then(response => response.json())
        .then(data => {
            container.innerHTML = "";
            
            data.forEach(status => {
                // simple cleaner for the content
                const div = document.createElement("div");
                div.className = "toot-entry";
                div.style.marginBottom = "1rem";
                div.style.borderBottom = "1px solid #eee";
                div.style.paddingBottom = "0.5rem";
                
                // Handle Content Warnings (CW) - Simple version: just show "CW: [Text]"
                let content = status.content;
                if (status.spoiler_text) {
                    content = `<p><strong>CW: ${status.spoiler_text}</strong> <br> 
                               <span style="font-size:0.8rem; color:#666;">(Click post to view)</span></p>`;
                }
                div.innerHTML = `
                    <div style="display: flex; 
                                align-items: center; 
                                justify-content: flex-start; 
                                text-align: left;
                                margin-bottom: 10px;">
                        
                        <div style="width: 60px; min-width: 60px; margin-right: 15px;">
                            <img src="${status.account.avatar}" 
                                 style="width: 60px; height: 60px; 
                                        border-radius: 15%; 
                                        display: block; 
                                        margin: 0 !important;
                                        max-width: none;">
                        </div>
                        
                        <div style="flex-grow: 1; line-height: 1.2; text-align: left;">
                            <a href="${status.account.url}" style="font-weight: bold; text-decoration: none; color: inherit; font-size: 0.9rem;">
                                ${status.account.display_name}
                            </a>
                        </div>
                    </div>
                    
                    <div style="font-size: 0.9rem; color: #333; text-align: left; line-height: 1.4;">
                        <a href="${status.url}" target="_blank" style="text-decoration: none; color: inherit;">
                            ${content}
                        </a>
                    </div>
                `;
                container.appendChild(div);
            });
            })
            .catch(err => {
            container.innerHTML = "Currently quiet in the tavern.";
            });
        });
        </script>
    </socialtimeline>
    
    <!-- Ads -->
    <ads>
      <div>
        <center><h3>Donations appreciated</h3></center>
        <p>
          This site does not track you or invade your privacy in any way. At the moment I'm running it at a loss,
          but I'm hoping to be able to pay for the running costs through donations so I won't have to
          resort to ads in the future. If you would like to support me with a small donation, it would be greatly
          appreciated.
        </p>
        <center>
          <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script>
          <script type='text/javascript'>kofiwidget2.init('Support me on Ko-fi', '#2d6b4c', 'D1D3MAPEA');kofiwidget2.draw();</script>
        </center>
      </div>
    </ads>

    <!-- Popular -->
    <popular>
      <div>
        <h3>Popular articles</h3>
        <ol>
          <li>
            <a href="/travel_and_exploration_in_rpgs.html">Travel and exploration in RPGs</a>
          </li>
          <li>
            <a href="/npc_generator.html">NPC Generator</a>
          </li>
          <li>
            <a href="2d6_weather_system.html">2d6 Weather System</a>
          </li>
        </ol>
      </div>
    </popular>
  </aside>
  
  <!-- The footer -->
  <footer>
    <div>
      Copyright Â© 2026 <a href="mailto:christer.enfors@gmail.com">Christer Enfors</a>.
    </div>
  </footer>
</body>
    
